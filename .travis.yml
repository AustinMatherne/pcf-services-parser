os: linux
dist: xenial
cache: yarn
language: node_js
node_js:
  - "11"
branches:
  only:
    - master
install: yarn install --frozen-lockfile
script:
  - yarn commitlint-travis
  - yarn test --ci
  - yarn lint
  - yarn build
jobs:
  include:
    - stage: test
      env:
        - secure: XRcX1BEmCajmOCaVarOoLiRAG7g1DeiRkVh0tzcbhaqdVKr3fQ7wf3lkuiPOFzvnpHaGKK1UsVIkUdm5Fu0oiALhkfDzYrNeKkS4ber1gPu0wJIpbCCRQVeSIN0s6Tl0I+WUJzQk0Oppk+OGEeW1GOsl6zRKLgQIKROKiDGGB7j21uA2Hal4nGvTx2FUC6DiScK+/4Jb0lDjEeg6s7Iv1WOwUhSejUJ6qcnaByeOX46ifIJ7OjcVNizZviIDS8vZZ9eAQLMNuqwVjQEp7OMmR+IbFiF6ZfVzOupCO2ed52gj/9HiVw+V/pkvxfWMhtdf2MW64bxm522j9biW58NUawWDUljXlUkLHPyAjHx08lUIHPr1QR+kywSNs7UOWWWkaJXH/zxJ7020NLNoJqSiWEh82fZdtE6hS2Pq0ODGuYKQDFxG3Xy9Qk+iz9VvuQnuGFqijLoQ1ap9z8hEVbIVDfixYFRB/M+IwhzgFIV4Rds4uuPwlR9zvdwif+XDTyv6JcAcox0N0FW+vcQOfsi/DK6/U/FvDZTOZrirUBrpekNTfqhIj+K80c8wUJGf0/8FJE2IxjsYGDIcdOA5Vr+jHNzUL2gOfZmaZnrejihmsrMX75PEglu0ITftUoEFWnWBOi2nW2NQjqegEDO1jpSjAwnyUxBqNIQ6k62BhibH8ao=
      before_script:
        - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
        - chmod +x ./cc-test-reporter
        - ./cc-test-reporter before-build
      after_script:
        - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
    - stage: test
      node_js: "10"
    - stage: test
      node_js: "8"
    - stage: release
      if: type == push
      script: skip
      skip_cleanup: true
      env:
        - secure: rP1cFzA51vZdBMVjUdnB+DkqUpS5FdUnCL2HCbhU3LI561gyzSI8Rkf+4YFS4t19p1v57umcGLqX15e65xwbHEEVa3d1pW393gzj7FaXgWOLp7un/AGGvBrxTMmJXQO3uloagZPDozLWVUB5M3C8ke2SXgcv+anjdfyxW1D++qU7haFQCYJPOjb0Lgxgme8W9w4SAO4coRd5PM7Srec94WT/IDOXf6GmeL2jcW+Dmk9kqmx//7qPx8MIQR3EOiVbcle3MIdVVt1jk3paBmBCnb9ij7I6WkWl2/rbfdkP1BHwxImdYT8t58mA6IhcLPof6JKSN6taYHJoYG1SCesX19ud2QSSNYg2/dEUF9ZoquE61zMaagSvTPsba15Itue1xpQ56qmx4G9V73T/4j2l0Q6TQx7D1/+YokUz0THCjkzWsDaL0DnEYt2r3XY/CkywX9eCTCDwfVqfG0T1rsq3In0Ps/4RcR/jCx46N519Zu1sBO8bwTFDQ/cdVyBEk3IkSWlh0ZkfUXytjsVkOAWSzC3/Rzu+4upJg2s4OTEhb9XhT4QabtTFAQI4oQKzt3kMv6Z3yTjVmPKOX07GKZ+NwyjXoYJuZJMIFcaXfvHEYTjmsqXR1utwnBYGEwKdjD/XOxVRFip4PmXnWxjolsjvh28lJGhNscjy5TSoY9QYz0Y=
        - secure: c19xtWwxADVwVvApaqpDLwlHyXDE7vOQSgcyavdQuNoRILSOzce6pQP0/LcMJ2eDrDMGpPlMmoTzyljeMSKNV1hXUonzRArMN0zN3tHEuT8hP5StHtfw6Qfr8rm1Zt/q8cT99qX7NSKDE7+1Qy2zOQujvqqRXY13y5hu49eK0RwG25SN0CgVa+KgHHlGsA8Ka4STVaRQFSKO3DXiZvmKI1YH3031qzD1j5kmiYzJLMVujQFxTfkdgSR5Q4i4F1KNWjiWmh8IFlOnttUW4QGEEgm+OvoxIQlCFdG1CULoXAEAi7zH8k8uA/FIksTosj+olZmptjX/V+E3avNot7sAQFk3NSwDjF/c9BVvhYz1C7vInhG610w1xGyDMjX9HhZ232UkskmhJtEXZIyGRP0apfS3uSiKzRPd7F/tfpoyap3cIRhvun2xti4udP0jWRJfe5weqdIzdZ1Fb6zTefVjL94KpIobDuDEjAdWcM0mW9y1vyraiv1K9u58G4aNXnmGEYJWv5zibQH5STcjwXoPFNBlNZaxaj/xNIQMBoP1ibgVscmSDYlcOE0qKxn9S+alrUmeFEqmNM94AkH5pKn0luBVQ1qyuOgZAosir/J6SEVQpM1Vj8TR0ri8ZKNVZqJZ0eHmr0MWy5+ZlA/GnCOhpRHZi2GSR9bn7p8Vclq2iSI=
      deploy:
        provider: script
        script: yarn release
